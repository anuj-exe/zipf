<html>
    <head>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
        <link href='https://fonts.googleapis.com/css?family=Source Sans Pro' rel='stylesheet'>
        <link href='https://fonts.googleapis.com/css?family=Muli' rel='stylesheet'>
        <link rel="stylesheet" href="dist/css/jquery.simple-bar-graph.min.css" />
        <script src="dist/js/jquery.simple-bar-graph.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
                
        <style>
            body{background:#1e1e1e;}
            .simple-bar-graph__bar {background-color: rgb(255, 0, 0);
                                    width: 30px;
                                    color:white;}
            .strbtn {
                align-items: center !important;
                background: #f5f5fa;
                border: 0;
                border-radius: 8px;
                box-shadow: -10px -10px 30px 0 #fff,10px 10px 30px 0 #1d0dca17;
                box-sizing: border-box;
                color: #2a1f62;
                cursor: pointer;
                font-family: "Cascadia Code",Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;
                justify-content: center !important;
                line-height: 1.5rem;
                padding: 15px;
                text-align: center;
                transition: .2s;
                touch-action: manipulation;
                white-space: pre;
                width: max-content;

            }

            .strbtn:hover {
              background: #f8f8ff;
              box-shadow: -15px -15px 30px 0 #fff, 15px 15px 30px 0 #1d0dca17;
            }

            @media (min-width: 768px) {
            .strbtn {
                padding: 10px;
            }
            }
        

        
            
        </style>  
    </head>


    <body>


        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container-fluid">
              <a class="navbar-brand" href="#">Navbar</a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                  <a class="nav-link active" aria-current="page" href="#">Home</a>
                  <a class="nav-link" href="#">Features</a>
                  <a class="nav-link" href="#">Pricing</a>

                </div>
              </div>
            </div>
          </nav>





        <div style="text-align: center;"><br>
            <div style="display: inline-block; text-align: left;">
                <p><a href="#vsauce"><span class="strbtn" style="font-size: 40px;">ZIPF'S LAW</span></a>
                <br><br>
                <p style="width:500px; color:white; font-family: 'Muli'; font-size: 22px;">
                Zipf's law test for your custom text.<br>
                Paste your text into this text area, <br> and hit the Zipfy button below it. <br><br>
                The graph ranks occurrences of most repeated words.
                <br><br>
                The line graph has an ideal line too,<br>to compare your text's distribution
                to the ideal Zipf distribution.
                </p>
            </div>
        </div>
        

        <div style="text-align:center;">
            <textarea style="font-size:20px;width:500px;height:300px; color:white; background-color : rgb(23, 25, 31); " type="text" id="strin"></textarea> <br><br><br>
            <button style="font-size:20px; " class="strbtn" id="strbtn" onclick="getstr()">
                ZIPFY
            </button>
        </div>
        <br>
        
        <div style="width: 100%;  overflow: hidden; text-align:center;">
        <div id="stuff" style="text-align:center; margin: auto; color: white; font-family: 'Source Sans Pro'; font-size:35px; width:auto; max-width:650px;"><p style="font-size:50px;">Loading...<br><br><br><br> The Graph goes here..</p></div>
        <br><br>
    
        <canvas id="myChart" style="margin: auto; width:98%; max-width:650px; height:500px;"></canvas>
    
        </div> <br>
        <div style="text-align: center;">
        <iframe id="vsauce" width="420" height="345" src="https://www.youtube.com/embed/fCn8zs912OE?autoplay=1&mute=0">
        </iframe>
        </div>


        <script>
            function getstr(){
                let str = document.getElementById('strin').value;
                console.log(str);
            
            str = str.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"");
            str = str.replace(/\s{2,}/g," ");
            str = str.toUpperCase();
            var stringarrayed = str.split(" ");
            const occurrences = stringarrayed.reduce(function (acc, curr) {
                return acc[curr] ? ++acc[curr] : acc[curr] = 1, acc
            }, {});
            
            var ordered = [];
            for (var i in occurrences) {
                ordered.push([i, occurrences[i]]);
            }
                ordered.sort(function(a, b) {
                return a[1] - b[1];
            });
            var objSorted = {}
            ordered.forEach(function(item){
                objSorted[item[0]]=item[1]
            })

            
            var sortedarr = [] ;
            for (var z = 0; z < (Object.keys(objSorted).length); z++) {
                sortedarr.push({
                key: Object.keys(objSorted)[z],
                value: Object.values(objSorted)[z]
                });
            }

            var byval = sortedarr.slice(0);
            byval.sort(function(a,b) {
            return a.value - b.value;
            });

            

            //data to feed graph
            var myData = [];
            var clabel = [];
            var cdata = [];
            var numberr = (byval.length)-1;
            var numcounter=numberr;
            while ((numberr>=0) && ((numcounter-numberr)<10))
            {
                var tempkey = String(byval[numberr].key);
                myData.push({key:[byval[numberr].key], value : byval[numberr].value});
                clabel.push(byval[numberr].key);
                cdata.push(byval[numberr].value);
                numberr-=1;
            }

            
            idealn=byval[((byval.length)-1)].value;
            idealdist=[];
            var n=1;
            while(n<11){
                idealdist.push(Math.round(idealn/n));
                n++;
            }

            console.log(idealdist); 

            $('#stuff').simpleBarGraph({
                data: myData,
                rowsCount: 5,
                rowCaptionsWidth: '20px',
                height: '400px',
                width:'600px;',
                delay: 10
            });





            //CHARTjs
            var ctx = document.getElementById('myChart').getContext('2d');
var myChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: clabel,
        datasets: [{
            label: 'Occurences of a word in the string',
            lineTension: 0,     
            data: cdata,
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        },{
            label: 'Ideal Zipf distribution.',
            lineTension: 0,     
            data: idealdist,
            backgroundColor: [
                'rgba(4, 170, 109, 0.2)'
            ],
            borderColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ]

        }]
    },
    options: {bezierCurve: false,
        scales: {
            y: {
                beginAtZero: true
            }
        }


    }
});












            
           
        }


        

    
	



            </script>
            
    </body>
</html>